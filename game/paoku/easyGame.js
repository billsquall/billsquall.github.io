(function(e){var t=function(){var n={},r=arguments[0],s=r.canvas,o=s.width,u=s.height,a=s.getContext("2d");if(t.versions.android||t.versions.iPhone)s.style.width="100%",s.style.height="100%";return n={objList:[],imgList:{},getImg:function(e){return this.imgList[e]},canvas:s,fps:r.fps,timeline:0,ctx:s.getContext("2d"),canWidth:o,canHeight:u,p_x:1,p_y:1,loading:function(e,t){this.l_t=0,this.imgList.length=0;for(var n=0;n<e.length;n++){var r=e[n];this.imgList[r.id]=new Image,this.imgList[r.id].src=r.url,this.imgList.length++}this.loadfuc=t,this.loadTimer=setInterval(function(){this.drawLoading()}.bind(this),30)},setEmpty:function(){this.objList=[],this.offtimefuc(),t.eventList={}},createLayer:function(e){var t=[];return!e||e>=this.objList.length-1?this.objList.push(t):e<=0?this.objList.unshift(t):this.objList.splice(e,0,t),t},drawLoading:function(){var e=0,t=this.ctx,n=this.canWidth,r=this.canHeight,s=this.imgList.length;for(i in this.imgList)i!="length"&&this.imgList[i].complete&&e++;t.beginPath(),t.clearRect(0,0,n,r),t.fillStyle="#000",t.fillRect(0,0,n,r),t.beginPath();var o=t.createLinearGradient(50,0,n,0);o.addColorStop(0,"#777"),o.addColorStop(Math.sin(this.l_t++%71*Math.PI/140),"#fff"),o.addColorStop(1,"#777"),t.fillStyle=o,t.fillRect(50,r/2-10,(n-100)/s*e,14),t.fill(),t.beginPath(),t.lineWidth="1",t.strokeStyle="#fff",t.rect(46,r/2-13,n-92,20),t.stroke(),t.beginPath(),t.fillStyle="#eee",t.font="14px Arial bold",t.fillText("LOADING...",n/2-100,r/2+36),t.fillText(e+"/"+s,n/2,r/2+36),t.fill(),e==s&&(clearInterval(this.loadTimer),t.clearRect(0,0,n,r),this.init(),this.loadfuc())},gameStart:function(){this.stimer=this.requestAnimFrame(function(){this.gameStart()}.bind(this)),this.timeline&&(this.tlinefuc(this.timeline),this.timeline++),this.__render(),this.__drawFPS((new Date).getTime())},gameOver:function(){this.cancelAFrame(this.stimer)},ontimefuc:function(e){this.timeline=1,this.tlinefuc=e},offtimefuc:function(){this.timeline=0},addEventListener:function(e){function r(r){if(eG.eventList[e]){var i=r.pageX*n.p_x,s=r.pageY*n.p_y,o=eG.eventList[e],u=0,a=o.length;for(;u<a;u++){var f=o[u];if(eG.OBBvsOBB(new t.OBB(new eG.Vector2(i,s),0,0,0),f.testObb()))for(var l=0;l<f.eventFuc[e].length;l++)f.eventFuc[e][l](r)}}}this.canvas.addEventListener(e,r);var n=this},__drawFPS:function(e){var t=1e3/(e-this.lastAnimationFrameTime);this.lastAnimationFrameTime=e,e-this.lastFpsUpdateTime>2e3&&(this.lastFpsUpdateTime=e,this.fps=t),this.ctx.font="18px Arial bold",this.ctx.fillText(Math.round(this.fps)+"FPS",10,26)},__render:function(){this.ctx.clearRect(0,0,this.canWidth,this.canHeight);var e=0,t=this.objList.length;for(;e<t;e++){var n=0,r=0,i=this.objList[e];for(;r<i.length;r++)i[r].die&&i.splice(r,1);var s=i.length;for(;n<s;n++){var o=i[n];o.static||(o.x+=this.__viewport.speed_x,o.y+=this.__viewport.speed_y),o.update(),o.render()}}},__viewport:{speed_x:0,speed_y:0},setviewPort:function(e,t){this.__viewport.speed_x=e||0,this.__viewport.speed_y=t||0},init:function(){this.lastAnimationFrameTime=0,this.lastFpsUpdateTime=0;if(t.versions.android||t.versions.iPhone)this.p_x=this.canWidth/e.innerWidth,this.p_y=this.canHeight/e.innerHeight;this.requestAnimFrame=function(){var t,n=r.fps;return n?t=function(t,r){e.setTimeout(t,1e3/n)}:t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,n){e.setTimeout(t,1e3/60)},t}().bind(),this.cancelAFrame=function(){return e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.mozCancelAnimationFrame||e.oCancelAnimationFrame||function(t){e.clearTimeout(t)}}().bind()}},n.extend=function(){var e,t,n,r,i=this;if((e=arguments[0])!=null)for(t in e){n=i[t],r=e[t];if(i===r)continue;i[t]=r}return i},n};t.versions=function(){var e=navigator.userAgent,t=navigator.appVersion;return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")==-1,ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:e.indexOf("Safari")==-1}}(),t.inherit=function(e,t){var n=new Function;n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.superclass=t.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=t)},t.extend=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},t.createSprite=function(e){var n=function(n){t.extend(this,e),t.Sprite.call(this,n)};return t.inherit(n,t.Sprite),n},t.createBitmap=function(e){var n=function(n){t.extend(this,e),t.Bitmap.call(this,n)};return t.inherit(n,t.Bitmap),n},t.eventList={},t.DisplayObject=function(e){this.x=0,this.y=0,this.width=0,this.height=0,this.alpha=1,this.die=0,this.rotation=0,this.visible=0,this.scaleX=1,this.scaleY=1,this.ctx=null,this.obb=[],this.eventFuc={},this.static=0,this.timeline=0,this.onBuffer=0,t.extend(this,e),this.__init()},t.DisplayObject.prototype={__transform:function(e){e.translate(this.x,this.y),this.alpha<1&&(e.globalAlpha=this.alpha),this.rotation&&e.rotate(this.rotation),(this.scaleX!=1||this.scaleY!=1)&&context.scale(this.scaleX,this.scaleY)},render:function(){if(this.onBuffer)if(this.bufferTimer<this.duration)for(i in this.bufferObj)this[i]+=this.bufferObj[i],this.bufferTimer++;else this.onBuffer=0;this.timeline++;if(!this.visible){var e=this.ctx;e.save(),this.__transform(e),this.draw(e),e.restore()}},addEventListener:function(e,n){t.eventList[e]||(t.eventList[e]=[]),this.eventFuc[e]||(this.eventFuc[e]=[]),t.eventList[e].push(this),this.eventFuc[e].push(n.bind(this))},removeEventListener:function(e){t.eventList[e].splice(t.eventList[e].indexOf(this),1),this.eventFuc[e]=[]},testObb:function(){return new t.OBB(new t.Vector2(this.x-this.__obb_x,this.y-this.__obb_y),this.__w,this.__h,this.rotation)},__init:function(){this.__w=this.obb[2]-this.obb[0],this.__h=this.obb[3]-this.obb[1],this.__obb_x=this.width/2-this.obb[0]-this.__w/2,this.__obb_y=this.height/2-this.obb[1]-this.__h/2},setObb:function(e){this.obb=e},checkBorder:function(){return t.OBBvsOBB(this.testObb(),new OBB(new t.Vector2(canvas_w/2,canvas_h/2),canvas_w,canvas_h,0))},remove:function(){this.die=1},to:function(e,t){this.onBuffer=1,this.bufferTimer=0,this.duration=t,this.bufferObj={};for(i in e)this.bufferObj[i]=(e[i]-this[i])/t}},t.Bitmap=function(e){t.DisplayObject.call(this,e)},t.inherit(t.Bitmap,t.DisplayObject),t.Bitmap.prototype.draw=function(e){e.drawImage(this.img,0,0,this.width,this.height,-this.width/2,-this.height/2,this.width,this.height)},t.Bitmap.prototype.update=function(){},t.Sprite=function(e){this.anim=null,t.DisplayObject.call(this,e)},t.inherit(t.Sprite,t.DisplayObject),t.Sprite.prototype.draw=function(e){e.drawImage(this.anim.img,this.anim.x,this.anim.y,this.width,this.height,-this.width/2,-this.height/2,this.width,this.height)},t.Sprite.prototype.setAnim=function(e){this.anim=e},t.Animdata=function(e,t,n){var r=[],i=e.height/t,s=e.width/n,o=0;for(;o<t;o++)for(var u=0;u<n;u++)r.push([u*s,i*o]);return r},t.Animation=function(e){this.ctx=null,this.img=null,this.frames=[],this.loop=0,this.speed=1,this.speed_t=0,this.frameIndex=0,t.extend(this,e),this.len=this.frames.length},t.Animation.prototype={update:function(){this.loop?(this.speed_t++,this.speed_t==this.speed&&(this.frameIndex++,this.speed_t=0),this.frameIndex==this.len&&(this.frameIndex=0)):this.frameIndex<this.len-1?(this.speed_t++,this.speed_t==this.speed&&(this.frameIndex++,this.speed_t=0)):this.endfuc&&this.endfuc(),this.x=this.frames[this.frameIndex][0],this.y=this.frames[this.frameIndex][1]},setEndfuc:function(e){this.endfuc=e},setSpeed:function(e){this.speed=e,this.speed_t=0},goframe:function(e){this.frameIndex=e,this.speed_t=0}},t.TextField=function(e){this.x=0,this.y=0,this.type="text",this.color="#000",this.size="12px",this.family="Arial",this.text="",this.weight="normal",this.die=0,this.ctx=null,this.t=0,t.extend(this,e)},t.TextField.prototype={render:function(){var e=this.ctx;e.save(),e.beginPath(),e.fillStyle="#fff",e.font=this.size+"px "+this.family+" "+this.weight,e.fillText(this.text,this.x,this.y+this.size),e.fill(),e.restore(),this.t++},update:function(){}},t.Math={random:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},coordinate:function(e,t,n,r,i){var s=(e-n)*Math.cos(i),o=(t-r)*Math.sin(i);return[Math.round(s-o+n),Math.round(s+o+n)]}},t.OBB=function(e,n,r,i){this.centerPoint=e,this.extents=[n/2,r/2],this.axes=[new t.Vector2(Math.cos(i),Math.sin(i)),new t.Vector2(-Math.sin(i),Math.cos(i))],this._width=n,this._height=r,this._rotation=i},t.OBB.prototype.getRadius=function(e){return this.extents[0]*Math.abs(e.dot(this.axes[0]))+this.extents[1]*Math.abs(e.dot(this.axes[1]))},t.Vector2=function(e,t){this.x=e||0,this.y=t||0},t.Vector2.prototype={sub:function(e){return new t.Vector2(this.x-e.x,this.y-e.y)},dot:function(e){return this.x*e.x+this.y*e.y}},t.OBBvsOBB=function(e,t){var n=e.centerPoint.sub(t.centerPoint),r=e.axes[0],i=e.axes[1],s=t.axes[0],o=t.axes[1];return e.getRadius(o)+t.getRadius(o)<=Math.abs(n.dot(o))||e.getRadius(s)+t.getRadius(s)<=Math.abs(n.dot(s))||e.getRadius(i)+t.getRadius(i)<=Math.abs(n.dot(i))||e.getRadius(r)+t.getRadius(r)<=Math.abs(n.dot(r))?0:1},e.eG=e.easyGame=t})(window);var buzz={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(e,t){function n(e){var t=[],n=e.length-1;for(var r=0;r<=n;r++)t.push({start:e.start(n),end:e.end(n)});return t}function r(e){return e.split(".").pop()}function i(e,t){var n=document.createElement("source");n.src=t,buzz.types[r(t)]&&(n.type=buzz.types[r(t)]),e.appendChild(n)}t=t||{};var s=0,o=[],u={},a=buzz.isSupported();this.load=function(){return a?(this.sound.load(),this):this},this.play=function(){return a?(this.sound.play(),this):this},this.togglePlay=function(){return a?(this.sound.paused?this.sound.play():this.sound.pause(),this):this},this.pause=function(){return a?(this.sound.pause(),this):this},this.isPaused=function(){return a?this.sound.paused:null},this.stop=function(){return a?(this.setTime(this.getDuration()),this.sound.pause(),this):this},this.isEnded=function(){return a?this.sound.ended:null},this.loop=function(){return a?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this):this},this.unloop=function(){return a?(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return a?(this.sound.muted=!0,this):this},this.unmute=function(){return a?(this.sound.muted=!1,this):this},this.toggleMute=function(){return a?(this.sound.muted=!this.sound.muted,this):this},this.isMuted=function(){return a?this.sound.muted:null},this.setVolume=function(e){return a?(e<0&&(e=0),e>100&&(e=100),this.volume=e,this.sound.volume=e/100,this):this},this.getVolume=function(){return a?this.volume:this},this.increaseVolume=function(e){return this.setVolume(this.volume+(e||1))},this.decreaseVolume=function(e){return this.setVolume(this.volume-(e||1))},this.setTime=function(e){return a?(this.whenReady(function(){this.sound.currentTime=e}),this):this},this.getTime=function(){if(!a)return null;var e=Math.round(this.sound.currentTime*100)/100;return isNaN(e)?buzz.defaults.placeholder:e},this.setPercent=function(e){return a?this.setTime(buzz.fromPercent(e,this.sound.duration)):this},this.getPercent=function(){if(!a)return null;var e=Math.round(buzz.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(e)?buzz.defaults.placeholder:e},this.setSpeed=function(e){if(!a)return this;this.sound.playbackRate=e},this.getSpeed=function(){return a?this.sound.playbackRate:null},this.getDuration=function(){if(!a)return null;var e=Math.round(this.sound.duration*100)/100;return isNaN(e)?buzz.defaults.placeholder:e},this.getPlayed=function(){return a?n(this.sound.played):null},this.getBuffered=function(){return a?n(this.sound.buffered):null},this.getSeekable=function(){return a?n(this.sound.seekable):null},this.getErrorCode=function(){return a&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!a)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return a?this.sound.readyState:null},this.getStateMessage=function(){if(!a)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return a?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!a)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(e,t){return a?(this.sound[e]=t,this):this},this.get=function(e){return a?e?this.sound[e]:this.sound:null},this.bind=function(e,t){if(!a)return this;e=e.split(" ");var n=this,r=function(e){t.call(n,e)};for(var i=0;i<e.length;i++){var s=e[i],u=s;s=u.split(".")[0],o.push({idx:u,func:r}),this.sound.addEventListener(s,r,!0)}return this},this.unbind=function(e){if(!a)return this;e=e.split(" ");for(var t=0;t<e.length;t++){var n=e[t],r=n.split(".")[0];for(var i=0;i<o.length;i++){var s=o[i].idx.split(".");if(o[i].idx==n||s[1]&&s[1]==n.replace(".",""))this.sound.removeEventListener(r,o[i].func,!0),delete o[i]}}return this},this.bindOnce=function(e,t){if(!a)return this;var n=this;u[s++]=!1,this.bind(s+e,function(){u[s]||(u[s]=!0,t.call(n)),n.unbind(s+e)})},this.trigger=function(e){if(!a)return this;e=e.split(" ");for(var t=0;t<e.length;t++){var n=e[t];for(var r=0;r<o.length;r++){var i=o[r].idx.split(".");if(o[r].idx==n||i[0]&&i[0]==n.replace(".","")){var s=document.createEvent("HTMLEvents");s.initEvent(i[0],!1,!0),this.sound.dispatchEvent(s)}}}return this},this.fadeTo=function(e,t,n){function r(){setTimeout(function(){i<e&&o.volume<e?(o.setVolume(o.volume+=1),r()):i>e&&o.volume>e?(o.setVolume(o.volume-=1),r()):n instanceof Function&&n.apply(o)},s)}if(!a)return this;t instanceof Function?(n=t,t=buzz.defaults.duration):t=t||buzz.defaults.duration;var i=this.volume,s=t/Math.abs(i-e),o=this;return this.play(),this.whenReady(function(){r()}),this},this.fadeIn=function(e,t){return a?this.setVolume(0).fadeTo(100,e,t):this},this.fadeOut=function(e,t){return a?this.fadeTo(0,e,t):this},this.fadeWith=function(e,t){return a?(this.fadeOut(t,function(){this.stop()}),e.play().fadeIn(t),this):this},this.whenReady=function(e){if(!a)return null;var t=this;this.sound.readyState===0?this.bind("canplay.buzzwhenready",function(){e.call(t)}):e.call(t)};if(a){for(var f in buzz.defaults)buzz.defaults.hasOwnProperty(f)&&(t[f]=t[f]||buzz.defaults[f]);this.sound=document.createElement("audio");if(e instanceof Array)for(var l in e)e.hasOwnProperty(l)&&i(this.sound,e[l]);else if(t.formats.length)for(var c in t.formats)t.formats.hasOwnProperty(c)&&i(this.sound,e+"."+t.formats[c]);else i(this.sound,e);t.loop&&this.loop(),t.autoplay&&(this.sound.autoplay="autoplay"),t.preload===!0?this.sound.preload="auto":t.preload===!1?this.sound.preload="none":this.sound.preload=t.preload,this.setVolume(t.volume),buzz.sounds.push(this)}},group:function(e){function t(){var t=n(null,arguments),r=t.shift();for(var i=0;i<e.length;i++)e[i][r].apply(e[i],t)}function n(e,t){return e instanceof Array?e:Array.prototype.slice.call(t)}e=n(e,arguments),this.getSounds=function(){return e},this.add=function(t){t=n(t,arguments);for(var r=0;r<t.length;r++)e.push(t[r])},this.remove=function(t){t=n(t,arguments);for(var r=0;r<t.length;r++)for(var i=0;i<e.length;i++)if(e[i]==t[r]){delete e[i];break}},this.load=function(){return t("load"),this},this.play=function(){return t("play"),this},this.togglePlay=function(){return t("togglePlay"),this},this.pause=function(e){return t("pause",e),this},this.stop=function(){return t("stop"),this},this.mute=function(){return t("mute"),this},this.unmute=function(){return t("unmute"),this},this.toggleMute=function(){return t("toggleMute"),this},this.setVolume=function(e){return t("setVolume",e),this},this.increaseVolume=function(e){return t("increaseVolume",e),this},this.decreaseVolume=function(e){return t("decreaseVolume",e),this},this.loop=function(){return t("loop"),this},this.unloop=function(){return t("unloop"),this},this.setTime=function(e){return t("setTime",e),this},this.setduration=function(e){return t("setduration",e),this},this.set=function(e,n){return t("set",e,n),this},this.bind=function(e,n){return t("bind",e,n),this},this.unbind=function(e){return t("unbind",e),this},this.bindOnce=function(e,n){return t("bindOnce",e,n),this},this.trigger=function(e){return t("trigger",e),this},this.fade=function(e,n,r,i){return t("fade",e,n,r,i),this},this.fadeIn=function(e,n){return t("fadeIn",e,n),this},this.fadeOut=function(e,n){return t("fadeOut",e,n),this}},all:function(){return new buzz.group(buzz.sounds)},isSupported:function(){return!!buzz.el.canPlayType},isOGGSupported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!buzz.el.canPlayType&&buzz.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!buzz.el.canPlayType&&(buzz.el.canPlayType("audio/x-m4a;")||buzz.el.canPlayType("audio/aac;"))},toTimer:function(e,t){var n,r,i;return n=Math.floor(e/3600),n=isNaN(n)?"--":n>=10?n:"0"+n,r=t?Math.floor(e/60%60):Math.floor(e/60),r=isNaN(r)?"--":r>=10?r:"0"+r,i=Math.floor(e%60),i=isNaN(i)?"--":i>=10?i:"0"+i,t?n+":"+r+":"+i:r+":"+i},fromTimer:function(e){var t=e.toString().split(":");return t&&t.length==3&&(e=parseInt(t[0],10)*3600+parseInt(t[1],10)*60+parseInt(t[2],10)),t&&t.length==2&&(e=parseInt(t[0],10)*60+parseInt(t[1],10)),e},toPercent:function(e,t,n){var r=Math.pow(10,n||0);return Math.round(e*100/t*r)/r},fromPercent:function(e,t,n){var r=Math.pow(10,n||0);return Math.round(t/100*e*r)/r}}